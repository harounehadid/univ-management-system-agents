!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.EventManager=n():e.EventManager=n()}(this,function(){return function(e){function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}var t={};return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},n.p="",n(n.s=0)}([function(e,n,t){"use strict";function o(e){if(Array.isArray(e)){for(var n=0,t=Array(e.length);n<e.length;n++)t[n]=e[n];return t}return Array.from(e)}function r(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(n,t,o){return t&&e(n.prototype,t),o&&e(n,o),n}}(),c=function e(n){r(this,e),this.name=n,this.callbacks=[],this.history=[]},l=function(){function e(){var n=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=t.manager,a=void 0===o?{}:o,i=t.logger;r(this,e),this.version=2,this._events={},a._events&&Object.entries(a._events).forEach(function(e){var t=e.eventName,o=e.eventObj;n._getEvent(t).callbacks=o.callbacks}),a._fired&&Object.entries(a._fired).forEach(function(e){var t=e.eventName;n._getEvent(t).triggered=!0}),this.logger=i||console,window.location.search.match("eventManagerDebug")?this.debugMode():window.document&&document.cookie.match("eventManagerDebug")?this.debugMode():window.localStorage&&window.localStorage.getItem("eventManagerDebug")&&this.debugMode()}return i(e,[{key:"on",value:function(e,n,t){var o=this;e.split(/\s/).forEach(function(e){var r=o._getEvent(e);t&&(n.context=t),r.callbacks.push(n)})}},{key:"off",value:function(e,n,t){var o=this;if(e){e.split(/\s/).forEach(function(e){var t=o._events[e];if(t)if(n){var r=t.callbacks.indexOf(n);-1!==r&&(t.callbacks.splice(r,1),0===t.callbacks.length&&delete o._events[e])}else t.callbacks=[]})}else n?this.removeCallbacksFromEvents(function(e){return e===n}):t&&this.removeCallbacksFromEvents(function(e){return e.context===t})}},{key:"removeCallbacksFromEvents",value:function(e){var n=this;for(var t in this._events)!function(t){var o=n._events[t],r=[];o.callbacks.forEach(function(n){e(n)||r.push(n)}),o.callbacks=r,0===o.callbacks.length&&delete n._events[t]}(t)}},{key:"once",value:function(e,n,t){n.once=!0,this.on(e,n,t)}},{key:"when",value:function(e,n,t){var o=this;e.split(/\s/).forEach(function(e){o._getEvent(e).history.length>0?o._call(n):o.once(e,n,t)})}},{key:"reset",value:function(){Object.values(this._events).forEach(function(e){e.history=[]})}},{key:"ever",value:function(e,n,t){var o=this;e.split(/\s/).forEach(function(e){var r=o._getEvent(e);r.history.length>0&&r.history.forEach(function(e){o._call(n,e)}),o.on(e,n,t)})}},{key:"trigger",value:function(e){for(var n=this,t=arguments.length,o=Array(t>1?t-1:0),r=1;r<t;r++)o[r-1]=arguments[r];e.split(/\s/).forEach(function(e){if("all"!==e){var t=n._getEvent(e);t.history.push(n._cloneObj(o)),t.callbacks.forEach(function(t){n._call(t,o),t.once&&n.off(e,t)}),n._getEvent("all").callbacks.forEach(function(t){n._call(t,[e].concat(o)),t.once&&n.off(e,t)})}})}},{key:"debugMode",value:function(){var e=this;this.logger.log("===== EventManager debug logging enabled ====="),this.on("all",function(n){for(var t=arguments.length,o=Array(t>1?t-1:0),r=1;r<t;r++)o[r-1]=arguments[r];e.logger.log("EventManager Event:",n,{args:o})})}},{key:"_getEvent",value:function(e){var n=void 0;return this._events[e]?n=this._events[e]:(n=new c(e),this._events[e]=n),n}},{key:"_call",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];try{e.context?e.bind(e.context).apply(void 0,o(n)):e.apply(void 0,o(n))}catch(e){this.logger.error(e)}}},{key:"_cloneObj",value:function(e){var n=this,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t>20?void this.logger.warn(new Error("Too many levels to clone object.")):"function"!=typeof e?"object"!==(void 0===e?"undefined":a(e))||e instanceof Date||null===e?e:Object.keys(e).reduce(function(o,r){return o[r]=n._cloneObj(e[r],t+1),o},Array.isArray(e)?[]:{}):void 0}}]),e}(),s=new l(window.EventManager);(!window.EventManager||!window.EventManager.version||window.EventManager.version<s.version)&&(window.EventManager=s),n.EventManager=l,n.default=s}])});