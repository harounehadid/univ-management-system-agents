!function(){function e(e,n){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),o.push.apply(o,t)}return o}function n(n){for(var o=1;o<arguments.length;o++){var i=null!=arguments[o]?arguments[o]:{};o%2?e(Object(i),!0).forEach((function(e){t(n,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):e(Object(i)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(i,e))}))}return n}function o(e){var n=function(e,n){if("object"!=typeof e||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var t=o.call(e,n||"default");if("object"!=typeof t)return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==typeof n?n:n+""}function t(e,n,t){return(n=o(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var t,i,r,a,d=[],l=!0,u=!1;try{if(r=(o=o.call(e)).next,0===n){if(Object(o)!==o)return;l=!1}else for(;!(l=(t=r.call(o)).done)&&(d.push(t.value),d.length!==n);l=!0);}catch(e){u=!0,i=e}finally{try{if(!l&&null!=o.return&&(a=o.return(),Object(a)!==a))return}finally{if(u)throw i}}return d}}(e,n)||function(e,n){if(!e)return;if("string"==typeof e)return r(e,n);var o=Object.prototype.toString.call(e).slice(8,-1);"Object"===o&&e.constructor&&(o=e.constructor.name);if("Map"===o||"Set"===o)return Array.from(e);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return r(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,n){(null==n||n>e.length)&&(n=e.length);for(var o=0,t=new Array(n);o<n;o++)t[o]=e[o];return t}var a=function(e){return void 0===e?void 0:e.replace(/[^\w-_. ]/gi,"").replace(/ /g,"")},d=function(e){var n=e.name;if(!n)throw new Error("name required");var o=i("undefined"!=typeof window&&document.cookie.match("(?:^|\\s)".concat(a(n),"=([^;]*)"))||[],2);o[0];var t=o[1];return a(t)};function l(e,n){var o,t,i;return e="string"==typeof e?e:"No log label provided",n=null!==(o=n)&&void 0!==o&&o.name&&null!==(t=n)&&void 0!==t&&t.message?n:{name:"No name provided for error log",message:"No message provided for error log"},console.error("DEO ".concat(e),n.name,n.message),null===(i=window)||void 0===i||null===(i=i.dtrum)||void 0===i||i.reportCustomError("DEO ".concat(e),n.name,n.message,!0),!1}function u(){var e={auth:"www.bestbuy.com"!==window.location.hostname,uri:"https://streams.bestbuy.com",authHeader:"YWthdGVzdDpiZXN0YnV5MjAyMA=="};return"www.stage.bestbuy.com"===window.location.hostname?e.uri="https://streams.stage.bestbuy.com":"www.test.bestbuy.com"===window.location.hostname&&(e.uri="https://streams.test.bestbuy.com"),e}var c,s=function(){var e,n,o,t,i,r,a,d,l,u,c;return"www.bestbuy.com"!==window.location.hostname&&"www.test.bestbuy.com"!==window.location.hostname&&"www.stage.bestbuy.com"!==window.location.hostname||"/"!==window.location.pathname?null!==(e=window)&&void 0!==e&&null!==(e=e.deoMetaData)&&void 0!==e&&e.blueprint&&window.deoMetaData.blueprint.includes("pdp")?"Product Detail Page":"search"===(null===(n=window)||void 0===n||null===(n=n.deoMetaData)||void 0===n?void 0:n.queryType)?"Search Results":"browse"===(null===(o=window)||void 0===o||null===(o=o.deoMetaData)||void 0===o?void 0:o.queryType)?"Browse List Page":"promo"===(null===(t=window)||void 0===t||null===(t=t.deoMetaData)||void 0===t?void 0:t.queryType)?"Promo List Page":null!==(i=window.location.pathname)&&void 0!==i&&i.includes("cart")?"Checkout: Cart - Index":null!==(r=window.location.pathname)&&void 0!==r&&r.includes("checkout")?"Checkout:":null!==(a=window.location.pathname)&&void 0!==a&&a.includes("thank-you")?"Thank you:":null!==(d=window.location.pathname)&&void 0!==d&&d.includes("deal-of-the-day")?"promo: Deal of the Day":null!==(l=window.location.pathname)&&void 0!==l&&l.includes("sale-page")?"promo: Special Sale":null!==(u=window)&&void 0!==u&&null!==(u=u.deoMetaData)&&void 0!==u&&u.type&&window.deoMetaData.type.includes("Deals")?"deals:":null!==(c=window)&&void 0!==c&&null!==(c=c.deoMetaData)&&void 0!==c&&c.type&&window.deoMetaData.type.includes("DeptCat")?"category:":"":"homepage: Best Buy"},w=function(){var e;return null!==(e=window)&&void 0!==e&&null!==(e=e.location)&&void 0!==e&&null!==(e=e.pathname)&&void 0!==e&&e.split("/").find((function(e){return"combo"===e}))?window.location.pathname.split("/")[window.location.pathname.split("/").length-1]:void 0},v=function(){var e=document.cookie&&document.cookie.split("MCMID")[1]?decodeURI(document.cookie.split("MCMID")[1]):"";return""===e?"":e.split("|")[1].split(";")[0]},m=function(){var e=Math.abs;try{var n=function(e){return"00".substring(0,2-e.length)+e},o=(new Date).getTimezoneOffset(),t=n("".concat(parseInt(e(o)/60))),i=n("".concat(e(o%60)));return"".concat(0<o?"UTC-":"UTC+").concat(t,":").concat(i)}catch(e){l("timeZone",e)}},p={name:"vt"},h={name:"ut"},g={name:"pt"},f={name:"bby_rdp"},y={name:"CartItemCount"},b={name:"locStoreId"},x=function(e){var n,o,t,i,r,a,l,u,c,x,D,O,I,M,S,j,k=null!==(n=window)&&void 0!==n&&null!==(n=n.deoMetaData)&&void 0!==n&&n.blueprint?window.deoMetaData.blueprint:void 0,P=d(p)?d(p):void 0,C=d(h)?d(h):void 0,N=d(g)?d(g):void 0,T=d(y)?parseInt(d(y)):0,U=d(f)?d(f):"NA",E=d(b)?d(b):void 0,A=null!==(o=window)&&void 0!==o&&null!==(o=o.deoMetaData)&&void 0!==o&&o.query?window.deoMetaData.query:void 0,q=!(null===(t=window)||void 0===t||null===(t=t.track)||void 0===t||null===(t=t.order)||void 0===t||!t.customerOrderId)&&window.track.order.customerOrderId,V=function(){var e;if(null!==(e=window)&&void 0!==e&&null!==(e=e.crypto)&&void 0!==e&&e.randomUUID)return window.crypto.randomUUID();var n=(new Date).getTime();return"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var o=0|(n+16*Math.random())%16;return("x"===e?o:8|3&o).toString(16)}))}();return JSON.stringify({eventUuid:V,contextId:"deo-client-script",contract:[{id:""}],interaction:{name:"pageVisit"},event:{hitIncrement:e.value.hitIncrement,type:"pageLoad"},application:{schemaName:"cj-page-visits",schemaVersion:"v1",schemaUri:"dar://dar.edp.bestbuy.com/entries/engagement/cj-page-visits/v1",version:"1.0.0"},source:{name:"BBY-US-Web",viewType:U,userAgent:null!==(i=window)&&void 0!==i&&null!==(i=i.navigator)&&void 0!==i&&i.userAgent?window.navigator.userAgent:void 0},device:{screenHeight:null!==(r=window)&&void 0!==r&&null!==(r=r.screen)&&void 0!==r&&r.height?parseInt(window.screen.height):0,screenWidth:null!==(a=window)&&void 0!==a&&null!==(a=a.screen)&&void 0!==a&&a.width?parseInt(window.screen.width):0,orientation:null!==(l=window)&&void 0!==l&&null!==(l=l.screen)&&void 0!==l&&null!==(l=l.orientation)&&void 0!==l&&l.type?window.screen.orientation.type:void 0,carrierName:"",osVersion:"",name:"",timeZone:m(),time:(new Date).toISOString().slice(0,19),connectionDownlink:null!==(u=window)&&void 0!==u&&null!==(u=u.navigator)&&void 0!==u&&null!==(u=u.connection)&&void 0!==u&&u.downlink?parseInt(window.navigator.connection.downlink):void 0,connectionEffectiveType:null!==(c=window)&&void 0!==c&&null!==(c=c.navigator)&&void 0!==c&&null!==(c=c.connection)&&void 0!==c&&c.effectiveType?window.navigator.connection.effectiveType:void 0},browser:{height:window.innerHeight?window.innerHeight:void 0,width:window.innerWidth?window.innerWidth:void 0,isWrapped:-1<document.cookie.indexOf("s_channel"),isCookiesDisabled:!(null!==(x=window)&&void 0!==x&&null!==(x=x.navigator)&&void 0!==x&&x.cookieEnabled),language:null!==(D=window)&&void 0!==D&&null!==(D=D.navigator)&&void 0!==D&&D.language?window.navigator.language:void 0,title:null!==(O=window)&&void 0!==O&&null!==(O=O.document)&&void 0!==O&&O.title?window.document.title:void 0,url:null!==(I=window)&&void 0!==I&&null!==(I=I.location)&&void 0!==I&&I.href?window.location.href:void 0,pathName:null!==(M=window)&&void 0!==M&&null!==(M=M.location)&&void 0!==M&&M.pathname?window.location.pathname:void 0,queryParams:null!==(S=window)&&void 0!==S&&null!==(S=S.location)&&void 0!==S&&S.search?window.location.search:void 0,hash:null!==(j=window)&&void 0!==j&&null!==(j=j.location)&&void 0!==j&&j.hash?window.location.hash:void 0},location:{defaultStoreId:E},appState:{uuid:V,name:s(),previousName:e.value.appStatePreviousName,previousUuid:e.value.appStatePreviousUuid,layout:k,referrerUrl:document.referrer?document.referrer:""},basket:{orderId:q||"",isPurchase:!!q&&!!q,displayCount:T},skus:[{id:-1<window.location.search.indexOf("skuId")?new URLSearchParams(window.location.search).get("skuId"):"",comboId:w()}],identities:{visitorId:P,userId:C,partyId:N,adobeId:v()},search:{query:A}})},D=function(e){var n={method:"POST",headers:{"Content-type":"application/json"},maxRedirects:10,redirect:"follow",body:x(e)};u().auth&&(n.headers.Authorization=u().authHeader),window.fetch("".concat(u().uri,"/customer/web-streams/v1/events/cj-page-visits"),n).catch((function(e){l("cj-page-visits fetch",{name:e.name,message:e.message})}))},O=function(){var e;return null!==(e=window)&&void 0!==e&&null!==(e=e.sessionStorage)&&void 0!==e&&e.getItem("cijCache")?JSON.parse(window.sessionStorage.getItem("cijCache")):{value:{appStatePreviousName:void 0,appStatePreviousUuid:void 0,hitIncrement:void 0}}};function I(){try{D(O())}catch(e){l("cj-page-visits",{name:e.name,message:e.message})}}I(),function(){var e;window.deoMetaData=n(n({},window.deoMetaData),{},{type:!1});var o=document.querySelector('meta[name="opt-targeting"]');if(o)try{window.deoMetaData=JSON.parse(o.getAttribute("content"))}catch(e){l("meta targeting",{name:"JSON parse error",message:"Error parsing DEO targeting meta tag"})}var t=function(){for(var e=[],n=[document];0<n.length;)for(var o,t=n.pop(),i=0;i<t.childNodes.length;i++)if(8===(o=t.childNodes[i]).nodeType&&-1<o.nodeValue.indexOf("blueprint")){var r=o.nodeValue.split("|")[1].replace("blueprint: id=","");e.push(r.trim())}else n.push(o);return e}(),i=!(!(0<t.length)||window.deoMetaData.blueprint)&&t[0].trim();null!==(e=window)&&void 0!==e&&null!==(e=e.deoMetaData)&&void 0!==e&&e.blueprint||(window.deoMetaData.blueprint=i)}(),c=!1,window.EventManager&&window.EventManager.on&&window.EventManager.on("checkoutStateChange",(function(e){var n;"thank-you"!==e||c||(c=!0,I(),null!==(n=window)&&void 0!==n&&null!==(n=n.track)&&void 0!==n&&null!==(n=n.order)&&void 0!==n&&n.customerOrderId||l("missing order id",{name:"Order ID Missing or Malformed",message:"The OrderId value expected in the payload is either missing or malformed"}))}))}();
//# sourceMappingURL=deo-client-script.js.map
